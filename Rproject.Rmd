---
title: "R Notebook"
output: html_notebook
---

This is an [R Markdown](http://rmarkdown.rstudio.com) Notebook. When you execute code within the notebook, the results appear beneath the code. 

Try executing this chunk by clicking the *Run* button within the chunk or by placing your cursor inside it and pressing *Ctrl+Shift+Enter*. 

```{r}
#install.packages("RODBC")
#install.packages("odbc")
#install.packages("reshape2")
#install.packages("ggplot2")
#install.packages("plyr")
#install.packages("sqldf")
#install.packages("data.table")
#install.packages("gridExtra")

library(RODBC) #connect mysql
#library(odbc) #connect mysql
library(lubridate) #date operation
library(magrittr) #pipe operation
library(reshape2)
library(ggplot2)
library(plyr)
library(sqldf)
library(gridExtra)
#library(data.table)
```

```{r}
#load data into R covid19_confirmed_global
#odbc <- dbConnect(odbc::odbc(), dsn = "coronavirus19")
data_confirmed <- odbcConnect("coronavirus19",uid = "root",pwd = "1234" )
#Data Cleaning

data_confirmed <- sqlQuery(data_confirmed, "SELECT * FROM covid19_confirmed_global ")

#Remove some columns and rename
data_confirmed <- data_confirmed[,!(names(data_confirmed) %in% c("Province.State","Lat","Long"))]%>%rename(c("Country.Region" = "Country"))
#covert from wide to long format
data_confirmed <- data_confirmed %>% gather(key=date,value=count,-c(Country))

View(data_confirmed)
```

```{r}
#load data into R covid19_deaths_global
data_deaths <- odbcConnect("coronavirus19",uid = "root",pwd = "1234" )
#Data Cleaning

data_deaths <- sqlQuery(data_deaths, "SELECT * FROM covid19_deaths_global ")
#Remove some columns and rename
data_deaths <- data_deaths[,!(names(data_deaths) %in% c("Province.State","Lat","Long"))]%>%rename(c("Country.Region" = "Country"))
#covert from wide to long format
data_deaths <- melt(data_deaths,id = c("Country")) %>% rename(c("variable" = "Date"))%>% rename(c("value"="deaths"))

#data2 <- sqldf("SELECT * FROM data1 WHERE date = '8/31/2020' group by Country order by confirmed desc ")
data_deaths <- sqldf("SELECT * FROM data_deaths order by Country")
#convert from charater to date and format
data_deaths$Date <- as.Date(data_deaths$Date,tryFormats = c("%m/%d/%Y", "%Y-%m-%d")) 

#check str
str(data_deaths)
View(data_deaths)
```



```{r}
#load data into R covid19_recovered_global
data_recovered <- odbcConnect("coronavirus19",uid = "root",pwd = "1234" )
#Data Cleaning

data_recovered <- sqlQuery(data_recovered, "SELECT * FROM covid19_recovered_global ")
#Remove some columns and rename
data_recovered <- data_recovered[,!(names(data_recovered) %in% c("Province.State","Lat","Long"))]%>%rename(c("Country.Region" = "Country"))
#covert from wide to long format
data_recovered <- melt(data_recovered,id = c("Country")) %>% rename(c("variable" = "Date"))%>% rename(c("value"="recovered"))

#data2 <- sqldf("SELECT * FROM data1 WHERE date = '8/31/2020' group by Country order by confirmed desc ")
data_recovered <- sqldf("SELECT * FROM data_recovered order by Country")
#convert from charater to date and format
data_recovered$Date <- as.Date(data_recovered$Date,tryFormats = c("%m/%d/%Y", "%Y-%m-%d")) 

#check str
str(data_recovered)
View(data_recovered)
```

```{r}
#load data into R Function data cleaning 
data <- odbcConnect("coronavirus19",uid = "root",pwd = "1234" )
#Data Cleaning

raw.confirmed <- sqlQuery(data, "SELECT * FROM covid19_confirmed_global")
raw.deaths <- sqlQuery(data, "SELECT * FROM covid19_deaths_global")
raw.recovered <- sqlQuery(data, "SELECT * FROM covid19_recovered_global")

n.col <- ncol(raw.confirmed)
## get dates from column names
dates <- names(raw.confirmed)[5:n.col] %>% mdy()
range(dates)

min.date <- min(dates)
max.date <- max(dates)
min.date.txt <- min.date %>% format('%d %b %Y')
max.date.txt <- max.date %>% format('%d %b %Y') %>% paste('UTC')


cleanData <- function(data){
  data <- data[,!(names(data) %in% c("Province.State","Lat","Long"))]%>%rename(c("Country.Region"="country"))
  data <- melt(data,id = c("country")) %>% rename(c("variable" = "date"))%>% rename(c("value"="count"))
  data <- aggregate(. ~ country + date , data = data, sum, na.rm=TRUE)%>% as.data.frame()
  data$date <- as.Date(data$date,tryFormats = c("%m/%d/%Y", "%Y-%m-%d")) 
 return(data)
}
dataConfirmed <- raw.confirmed %>% cleanData()%>% rename(c("count"="confirmed"))
dataDeaths <- raw.deaths %>% cleanData() %>% rename(c("count"="deaths"))
dataRecovered <- raw.recovered %>% cleanData() %>% rename(c("count"="recovered"))
#dataConfirmed

data_total <- dataConfirmed %>% merge(dataDeaths,all = T) %>% merge(dataRecovered,all = T)


#check str
#str(data_total)
#View(data_total)
View(data_total)
```

```{r}
#counts for the whole world

##dataDate <- sqldf("SELECT * FROM data_total group by Date")
#data_total1 <- subset(data_total1, select = -c(Country))
#world.Total <- aggregate(x = data_total[c("confirmed", "deaths", "recovered")], by = list(country = data_total$Country, date = data_total$Date), sum)
#world.Total

data_total <- dataConfirmed %>% merge(dataDeaths,all = T) %>% merge(dataRecovered,all = T)
data(data_total)
head(data_total)

#change country to "World"
data_total1 <- data_total
data_total1$country <- "World"

#group data by date and sum all (confirmed, deaths, recovered) cases
dataWorld  <- aggregate(. ~ country + date , data = data_total1, sum, na.rm=TRUE)
#dataWorld 
#View(dataWorld)

#merge 'World' statistic to main data frame
data_total <- rbind(data_total, dataWorld)
data_total <- sqldf("SELECT * FROM data_total group by country, date order by country")
#current confirmed cases
data_total$current.confirmed <- data_total$confirmed - data_total$deaths - data_total$recovered
data_total 
View(data_total)

```
```{r}
world.long <- data.long[data.long$country == 'World',]
rownames(world.long) <- NULL
#world.long
#case-area plot
plot1 <- world.long[world.long$Type != 'Total Confirmed',] %>%
  ggplot(aes(x=date, y=count)) +
  geom_area(aes(fill=Type), alpha=0.5) +
  labs(title=paste0('Numbers of Cases Worldwide - ', max.date.txt)) +
  scale_fill_manual(values=c('pink', 'green', 'orange')) +
  theme(legend.title=element_blank(), legend.position='bottom',
  plot.title = element_text(size=7),
  axis.title.x=element_blank(),
  axis.title.y=element_blank(),
  legend.key.size=unit(0.2, 'cm'),
  legend.text=element_text(size=6),
  axis.text=element_text(size=7),
  axis.text.x=element_text(angle=45, hjust=1))

plot2 <- world.long %>%
  ggplot(aes(x=date, y=count)) +
  geom_line(aes(color=Type)) +
  labs(title=paste0('Numbers of Cases Worldwide (log scale) - ', max.date.txt)) +
  scale_color_manual(values=c('purple', 'red', 'orange', 'black')) +
  theme(legend.title=element_blank(), legend.position='bottom',
  plot.title = element_text(size=7),
  axis.title.x=element_blank(),
  axis.title.y=element_blank(),
  legend.key.size=unit(0.2, 'cm'),
  legend.text=element_text(size=6),
  axis.text=element_text(size=7),
  axis.text.x=element_text(angle=45, hjust=1)) +
scale_y_continuous(trans='log10')
## show two plots side by side
grid.arrange(plot1, plot2, ncol=2)

```

```{r}
#sort by country and date
data_total %<>% arrange(country,date)

#daily increases of deaths and recovered cases
#set NA to the increases on day1
n <- nrow(data_total)
day1 <- min(data_total$date)
data_total %<>% mutate(new.confirmed = confirmed - c(NA,head(confirmed,-1)),
                 new.deaths = deaths - c(NA,head(deaths,-1)) ,
                 new.recovered = recovered - c(NA,head(recovered,-1)))

#change negative number of new case to zero
data_total %<>% mutate(new.confirmed = ifelse(new.confirmed < 0,0,new.confirmed),
                       new.deaths = ifelse(new.deaths < 0,0,new.deaths),
                       new.recovered = ifelse(new.recovered < 0,0,new.recovered))


#death rate based on total deaths and recovered cases
data_total %<>% mutate(rate.upper = (100*deaths/(deaths+recovered)) %>% round(1))
#lower bound: death rate based on total confirmed cases
data_total %<>% mutate(rate.lower = (100*deaths/confirmed) %>% round(1))
#death rate based on number of death/recovered on every single day
data_total %<>% mutate(rate.daily = (100*new.deaths/(new.deaths+new.recovered)) %>% round(1))

View(data_total)
#covert from wide to long format,for drawing area plots
#dataSelect1 <- sqldf("select Country,Date,confirmed,recovered,deaths from data_total")
#data_total

```

```{r}
data.world <- data_total[data_total$country == 'World',]
rownames(data.world) <- NULL
## current confirmed and daily new confirmed
plot1 <- ggplot(data.world, aes(x=date, y=current.confirmed)) +
  geom_point() + geom_smooth() +
  xlab('') + ylab('Count') + labs(title='Current Confirmed Cases') +
  theme(axis.text.x=element_text(angle=45, hjust=1))
plot2 <- ggplot(data.world, aes(x=date, y=new.confirmed)) +
  geom_point() + geom_smooth() +
  xlab('') + ylab('Count') + labs(title='Daily New Confirmed Cases') +
  theme(axis.text.x=element_text(angle=45, hjust=1))
## show two plots side by side
grid.arrange(plot1, plot2, ncol=2)

```

```{r}
## a scatter plot with a smoothed line and vertical x-axis labels
plot1 <- ggplot(data.world, aes(x=date, y=deaths)) +
  geom_point() + geom_smooth() +
  xlab('') + ylab('Count') + labs(title='Accumulative Deaths') +
  theme(axis.text.x=element_text(angle=45, hjust=1))
plot2 <- ggplot(data.world, aes(x=date, y=recovered)) +
  geom_point() + geom_smooth() +
  xlab('') + ylab('Count') + labs(title='Accumulative Recovered Cases') +
  theme(axis.text.x=element_text(angle=45, hjust=1))
plot3 <- ggplot(data.world, aes(x=date, y=new.deaths)) +
  geom_point() + geom_smooth() +
  xlab('') + ylab('Count') + labs(title='New Deaths') +
  theme(axis.text.x=element_text(angle=45, hjust=1))
plot4 <- ggplot(data.world, aes(x=date, y=new.recovered)) +
  geom_point() + geom_smooth() +
  xlab('') + ylab('Count') + labs(title='New Recovered Cases') +
  theme(axis.text.x=element_text(angle=45, hjust=1))
## show four plots together, with 2 plots in each row
grid.arrange(plot1, plot2, plot3, plot4, nrow=2)

```

```{r}
data.long <- data_total[,!(names(data_total) %in% c("new.confirmed","new.deaths","new.recovered","rate.upper","rate.lower","rate.daily"))]
#View(data.long)
data.long <- melt(data.long,id = c("country","date")) 
#View(data.long)
data.long <- data.long %>% rename(c("variable" = "Type")) %>% rename(c("value" = "count"))

data.long$Type <- as.character(data.long$Type)
data.long$Type[data.long$Type == "confirmed"] <- "Total Confirmed"
data.long$Type[data.long$Type == "current.confirmed"] <- "Current Confirmed"
data.long$Type[data.long$Type == "recovered"] <- "Recovered"
View(data.long)


rates.long <- data_total[,!(names(data_total) %in% c("new.confirmed","new.deaths","new.recovered","confirmed","current.confirmed","recovered","deaths"))]
#View(data.long)
rates.long <- melt(rates.long,id = c("country","date")) 
rates.long <- rates.long %>% rename(c("variable" = "Type")) %>% rename(c("value" = "count"))

rates.long$Type <- as.character(rates.long$Type)
rates.long$Type[rates.long$Type == "rate.daily"] <- "Daily"
rates.long$Type[rates.long$Type == "rate.lower"] <- "Lower Bound"
rates.long$Type[rates.long$Type == "rate.upper"] <- "Upper Bound"
View(rates.long)  
#set factor levels to show them in a desirable order

```


```{r}
#ranking by confirmed case
head(data_total)
dataDate <- data_total[data_total$date  == "2020-08-31",]%>%rename(c("rate.lower" = "death.rate"))
head(dataDate)
data.latest.all <- dataDate[,c("country","date","confirmed","new.confirmed","current.confirmed","recovered","deaths","new.deaths","death.rate")]
data.latest.all <- arrange(data.latest.all,desc(confirmed)) %>% mutate(ranking = rank(desc(confirmed)))

#View(data.latest.all)
k <- 20
#top 20 countries 21 incl.'World'
head(data.latest.all)
top.countries <- data.latest.all[data.latest.all$ranking <= k+1,] %>% arrange(ranking) 
top.countries
View(top.countries)

```

```{r}
#add 'Others'
data.latest <- data.latest.all[!is.na(data.latest.all$country),] %>% 
  mutate(country = ifelse(ranking <= k + 1, as.character(country), 'Others')) 
  mutate(data.latest, country = country %>% factor(levels=c(as.character(top.countries), 'Others')))
  
data.latest <-  ddply(data.latest, .(country, date), summarise,
                      confirmed = sum(confirmed), new.confirmed = sum(new.confirmed),
                      current.confirmed = sum(current.confirmed),
                      recovered = sum(recovered), deaths = sum(deaths), new.deaths = sum(new.deaths)) %>%
mutate(death.rate=(100 * deaths/confirmed) %>% round(1)) 

data.latest <- arrange(data.latest,desc(confirmed)) %>% mutate(ranking = rank(desc(confirmed)))
data.latest <- data.latest[,c("country", "confirmed", "deaths", "death.rate", "new.confirmed", "new.deaths", "current.confirmed")] 
data.latest <- data.latest[c(1:2, nrow(data.latest) , 4:21, 3),]
rownames(data.latest) <- NULL

data.latest
View(data.latest)

```
```{r}
data.latest.long <- data.latest[data.latest$country != 'World',] 
data.latest.long <- melt(data.latest.long, id = c("country")) 
data.latest.long <- data.latest.long%>% rename(c("variable" = "Type")) %>% rename(c("value" = "count"))
data.latest.long$Type <- as.character(data.latest.long$Type)
data.latest.long$Type[data.latest.long$Type == "confirmed"] <- "Total Confirmed"
data.latest.long$Type[data.latest.long$Type == "deaths"] <- "Total deaths"
data.latest.long$Type[data.latest.long$Type == "death.rate"] <- "Death Rate (%)"
data.latest.long$Type[data.latest.long$Type == "new.confirmed"] <- "New Confirmed"
data.latest.long$Type[data.latest.long$Type == "new.deaths"] <- "New Deaths"
data.latest.long$Type[data.latest.long$Type == "current.confirmed"] <- "Current Confirmed"
View(data.latest.long)
```

```{r}
data.latest.long %>% ggplot(aes(x=country, y=count, fill=country, group=country)) +
  geom_bar(stat='identity') +
  geom_text(aes(label=count, y=count), size=2, vjust=0) +
  xlab('') + ylab('') +
  labs(title=paste0('Top 20 Countries with Most Confirmed Cases- ', max.date.txt)) +
  scale_fill_discrete(name='Country', labels=aes(count)) +
  theme(legend.title=element_blank(),
        legend.position='none',
        plot.title=element_text(size=11),
        axis.text=element_text(size=7),
        axis.text.x=element_text(angle=45, hjust=1)) +
  facet_wrap(~Type, ncol=1, scales='free_y')

```


```{r}
#load data into R Function data cleaning 
data <- odbcConnect("coronavirus19",uid = "root",pwd = "1234" )
#Data Cleaning

dataGDP <- sqlQuery(data, "SELECT * FROM GDP")
#View(dataGDP)
dataGDP <- dataGDP[,c(1,34:43)]
rownames(dataGDP) <- NULL

data.longGDP <- melt(dataGDP,id = c(1)) 
#View(data.longGDP)
data.longGDP <- data.longGDP %>% rename(c("variable" = "Year")) %>% rename(c("value" = "GDP"))%>%rename(c("Real GDP growth (Annual percent change)" = "country"))
View(data.longGDP)

#raw.dataGDP <- sqldf("SELECT * FROM raw_dataGDP")
#View(dataGDP)
#dataGDP

```

```{r}
world.longGDP <- data.longGDP[data.longGDP$country == 'World',]
rownames(world.longGDP) <- NULL
africa.longGDP <- data.longGDP[data.longGDP$country == 'Africa (Region)',]
rownames(africa.longGDP) <- NULL
asia.longGDP <- data.longGDP[data.longGDP$country == 'Asia and Pacific',]
rownames(asia.longGDP) <- NULL
europe.longGDP <- data.longGDP[data.longGDP$country == 'Europe',]
rownames(europe.longGDP) <- NULL
asean.longGDP <- data.longGDP[data.longGDP$country == 'ASEAN-5',]
rownames(asean.longGDP) <- NULL
pacific.longGDP <- data.longGDP[data.longGDP$country == 'Pacific Islands',]
rownames(pacific.longGDP) <- NULL
#world.longGDP

world.longGDP$group <- cut(world.longGDP$GDP,c(-Inf,0,Inf),labels = c("-","+"))
africa.longGDP$group <- cut(africa.longGDP$GDP,c(-Inf,0,Inf),labels = c("-","+"))
asia.longGDP$group <- cut(asia.longGDP$GDP,c(-Inf,0,Inf),labels = c("-","+"))
europe.longGDP$group <- cut(europe.longGDP$GDP,c(-Inf,0,Inf),labels = c("-","+"))
asean.longGDP$group <- cut(asean.longGDP$GDP,c(-Inf,0,Inf),labels = c("-","+"))
pacific.longGDP$group <- cut(pacific.longGDP$GDP,c(-Inf,0,Inf),labels = c("-","+"))
#world.longGDP

plot1 <- ggplot(world.longGDP,aes(x=Year,y=GDP,fill = group ))+
    labs(title=paste0('Real GDP growth (Annual percent change) of World from 2012-2021'))+
    geom_bar(stat = "identity")+
    scale_fill_manual(values = c("-" = "red","+" = "limegreen"))+
    theme_bw() + theme(legend.position = "none")+
    xlab("")+
    theme(legend.title=element_blank(),
    plot.title = element_text(size=7))
plot2 <- ggplot(africa.longGDP,aes(x=Year,y=GDP,fill = group ))+
    labs(title=paste0('Real GDP growth (Annual percent change) of Africa (Region) from 2012-2021'))+
    geom_bar(stat = "identity")+
    scale_fill_manual(values = c("-" = "red","+" = "limegreen"))+
    theme_bw() + theme(legend.position = "none")+
    xlab("")+
    theme(legend.title=element_blank(),
    plot.title = element_text(size=7))
plot3 <- ggplot(asia.longGDP,aes(x=Year,y=GDP,fill = group ))+
    labs(title=paste0('Real GDP growth (Annual percent change) of Asia and Pacific from 2012-2021'))+
    geom_bar(stat = "identity")+
    scale_fill_manual(values = c("-" = "red","+" = "limegreen"))+
    theme_bw() + theme(legend.position = "none")+
    xlab("")+
    theme(legend.title=element_blank(),
    plot.title = element_text(size=7))
plot4 <- ggplot(europe.longGDP,aes(x=Year,y=GDP,fill = group ))+
    labs(title=paste0('Real GDP growth (Annual percent change) of Europe from 2012-2021'))+
    geom_bar(stat = "identity")+
    scale_fill_manual(values = c("-" = "red","+" = "limegreen"))+
    theme_bw() + theme(legend.position = "none")+
    xlab("")+
    theme(legend.title=element_blank(),
    plot.title = element_text(size=7))
plot5 <- ggplot(asean.longGDP,aes(x=Year,y=GDP,fill = group ))+
    labs(title=paste0('Real GDP growth (Annual percent change) of ASEAN-5 from 2012-2021'))+
    geom_bar(stat = "identity")+
    scale_fill_manual(values = c("-" = "red","+" = "limegreen"))+
    theme_bw() + theme(legend.position = "none")+
    xlab("")+
    theme(legend.title=element_blank(),
    plot.title = element_text(size=7))
plot6 <- ggplot(pacific.longGDP,aes(x=Year,y=GDP,fill = group ))+
    labs(title=paste0('Real GDP growth (Annual percent change) of Pacific Islands from 2012-2021'))+
    geom_bar(stat = "identity")+
    scale_fill_manual(values = c("-" = "red","+" = "limegreen"))+
    theme_bw() + theme(legend.position = "none")+
    xlab("")+
    theme(legend.title=element_blank(),
    plot.title = element_text(size=7))
grid.arrange(plot1)
grid.arrange(plot2)
grid.arrange(plot3)
grid.arrange(plot4)
grid.arrange(plot5)
grid.arrange(plot6)

```
```{r}
#data_total_GDP <- data.longGDP %>% merge(dataConfirmed,by = "country") 
#View(data_total_GDP)
```
```{r}
#Top 20 Countries in GDP 2020 desc
#ranking by GDP
head(data.longGDP)
dataYear <- data.longGDP[data.longGDP$Year  == "2020",]
data.latest.GDP <- dataYear[,c("country","Year","GDP")]
data.latest.GDP <- arrange(data.latest.GDP,desc(GDP)) %>% mutate(ranking = rank(GDP))


#View(data.latest.all)
k <- 20
#top 20 countries 21 incl.'World'
head(data.latest.GDP)
top.GDP <- data.latest.GDP[data.latest.GDP$ranking <= k+1,] %>% arrange(ranking) 
top.GDP
#View(top.GDP)
#View(top.countries)


```
```{r}
#Top 20 Countries in GDP 2020 desc
#ranking by GDP
head(data.longGDP)
dataYear <- data.longGDP[data.longGDP$Year  == "2020",]
head(dataYear)
data.latest.GDP <- dataYear[,c("country","Year","GDP")]
data.latest.GDP.desc <- arrange(data.latest.GDP,desc(GDP)) %>% mutate(ranking = rank(GDP, na.last = TRUE, ties.method = "min"))

#View(data.latest.all)
k <- 28
#top 20 countries 21 incl.'World'
head(data.latest.GDP.desc)
top.GDP.desc <- data.latest.GDP.desc[data.latest.GDP.desc$ranking <= k+1,] %>% arrange(ranking) 
View(top.GDP.desc)
#View(top.countries)

```

```{r}
#View(data.latest.GDP)
data.latest.GDP.top <- arrange(data.latest.GDP, desc(GDP)) %>% mutate(ranking = rank(desc(GDP), na.last = TRUE, ties.method = "min"))
data.latest.GDP.top

k <- 28
#top 20 countries 21 incl.'World'
head(data.latest.GDP.top)
top.GDP <- data.latest.GDP.top[data.latest.GDP.top$ranking <= k+1,] %>% arrange(ranking) 
View(top.GDP)
```

```{r}
topcountries.gdp <- top.countries %>% merge(data.longGDP, by = "country")
topcountries.gdp <- topcountries.gdp[,(names(topcountries.gdp) %in% c("country","Year","GDP"))]
View(topcountries.gdp)
```

```{r}
world.gdp <- topcountries.gdp[topcountries.gdp$country == 'World',] %>% arrange(Year) %>%
  ggplot(aes(x=Year, y=GDP)) +
  geom_line() +
  labs(title = 'World GDP 2012 - 2021') +
  theme(legend,title = element_blank(), legend.position = 'bottom',
        plot.title = element_text(size=12),
        axis.title.x=element_blank(),
        axis.title.y=element_blank(),
        legend.key.size = unit(0.4, 'cm'),
        strip.text.x = element_text(size=7),
        axis.text = element_text(size=7),
        axis.text.x=element_text(angle=45, hjust = 1)) +
  scale_y_continuous(trans='log10')
#world.gdp + facet_wrap(~country, ncol=2, scales = 'free_y')
world.gdp

```


```{r}
gdp.all <- topcountries.gdp %>% arrange(Year) %>%
  ggplot(aes(x=Year, y=GDP, group = country, color = country)) +
  geom_line(size = 1) +
  #geom_point() +
  labs(title = 'Top 20 Countries Real GDP growth (Annual percent change) 2012 - 2021')
#gdp.all

gdp.us <- topcountries.gdp[ which (topcountries.gdp$country == 'US' | topcountries.gdp$country == 'World'),] %>% arrange(Year) %>%
  ggplot(aes(x=Year, y=GDP, group = country, color = country)) +
  geom_line(size = 1) +
  geom_point() +
  labs(title = 'World & US GDP 2012 - 2021')
#gdp.us

gdp.brazil <- topcountries.gdp[ which (topcountries.gdp$country == 'Brazil' | topcountries.gdp$country == 'World'),] %>% arrange(Year) %>%
  ggplot(aes(x=Year, y=GDP, group = country, color = country)) +
  geom_line(size = 1) +
  geom_point() +
  labs(title = 'World & Brazil GDP 2012 - 2021')
#gdp.brazil

gdp.india <- topcountries.gdp[ which (topcountries.gdp$country == 'India' | topcountries.gdp$country == 'World'),] %>% arrange(Year) %>%
  ggplot(aes(x=Year, y=GDP, group = country, color = country)) +
  geom_line(size = 1) +
  geom_point() +
  labs(title = 'World & India GDP 2012 - 2021')
#gdp.india

gdp.russia <- topcountries.gdp[ which (topcountries.gdp$country == 'Russia' | topcountries.gdp$country == 'World'),] %>% arrange(Year) %>%
  ggplot(aes(x=Year, y=GDP, group = country, color = country)) +
  geom_line(size = 1) +
  geom_point() +
  labs(title = 'World & Russia GDP 2012 - 2021')
#gdp.russia

gdp.peru <- topcountries.gdp[ which (topcountries.gdp$country == 'Peru' | topcountries.gdp$country == 'World'),] %>% arrange(Year) %>%
  ggplot(aes(x=Year, y=GDP, group = country, color = country)) +
  geom_line(size = 1) +
  geom_point() +
  labs(title = 'World & Peru GDP 2012 - 2021')
#gdp.peru

gdp.southAf <- topcountries.gdp[ which (topcountries.gdp$country == 'South Africa' | topcountries.gdp$country == 'World'),] %>% arrange(Year) %>%
  ggplot(aes(x=Year, y=GDP, group = country, color = country)) +
  geom_line(size = 1) +
  geom_point() +
  labs(title = 'World & South Africa GDP 2012 - 2021')
#gdp.southAf

gdp.colombia <- topcountries.gdp[ which (topcountries.gdp$country == 'Colombia' | topcountries.gdp$country == 'World'),] %>% arrange(Year) %>%
  ggplot(aes(x=Year, y=GDP, group = country, color = country)) +
  geom_line(size = 1) +
  geom_point() +
  labs(title = 'World & Colombia GDP 2012 - 2021')
#gdp.colombia

gdp.mexico <- topcountries.gdp[ which (topcountries.gdp$country == 'Mexico' | topcountries.gdp$country == 'World'),] %>% arrange(Year) %>%
  ggplot(aes(x=Year, y=GDP, group = country, color = country)) +
  geom_line(size = 1) +
  geom_point() +
  labs(title = 'World & Mexico GDP 2012 - 2021')
#gdp.mexico

gdp.spain <- topcountries.gdp[ which (topcountries.gdp$country == 'Spain' | topcountries.gdp$country == 'World'),] %>% arrange(Year) %>%
  ggplot(aes(x=Year, y=GDP, group = country, color = country)) +
  geom_line(size = 1) +
  geom_point() +
  labs(title = 'World & Spain GDP 2012 - 2021')
#gdp.spain

gdp.argentina <- topcountries.gdp[ which (topcountries.gdp$country == 'Argentina' | topcountries.gdp$country == 'World'),] %>% arrange(Year) %>%
  ggplot(aes(x=Year, y=GDP, group = country, color = country)) +
  geom_line(size = 1) +
  geom_point() +
  labs(title = 'World & Argentina GDP 2012 - 2021')
#gdp.argentina

gdp.chile <- topcountries.gdp[ which (topcountries.gdp$country == 'Chile' | topcountries.gdp$country == 'World'),] %>% arrange(Year) %>%
  ggplot(aes(x=Year, y=GDP, group = country, color = country)) +
  geom_line(size = 1) +
  geom_point() +
  labs(title = 'World & Chile GDP 2012 - 2021')
#gdp.chile

gdp.iran <- topcountries.gdp[ which (topcountries.gdp$country == 'Iran' | topcountries.gdp$country == 'World'),] %>% arrange(Year) %>%
  ggplot(aes(x=Year, y=GDP, group = country, color = country)) +
  geom_line(size = 1) +
  geom_point() +
  labs(title = 'World & Iran GDP 2012 - 2021')
#gdp.iran

gdp.uk <- topcountries.gdp[ which (topcountries.gdp$country == 'United Kingdom' | topcountries.gdp$country == 'World'),] %>% arrange(Year) %>%
  ggplot(aes(x=Year, y=GDP, group = country, color = country)) +
  geom_line(size = 1) +
  geom_point() +
  labs(title = 'World & United Kingdom GDP 2012 - 2021')
#gdp.uk

gdp.france <- topcountries.gdp[ which (topcountries.gdp$country == 'France' | topcountries.gdp$country == 'World'),] %>% arrange(Year) %>%
  ggplot(aes(x=Year, y=GDP, group = country, color = country)) +
  geom_line(size = 1) +
  geom_point() +
  labs(title = 'World & France GDP 2012 - 2021')
#gdp.france

gdp.saudi <- topcountries.gdp[ which (topcountries.gdp$country == 'Saudi Arabia' | topcountries.gdp$country == 'World'),] %>% arrange(Year) %>%
  ggplot(aes(x=Year, y=GDP, group = country, color = country)) +
  geom_line(size = 1) +
  geom_point() +
  labs(title = 'World & Saudi Arabia GDP 2012 - 2021')
#gdp.saudi

gdp.bangladesh <- topcountries.gdp[ which (topcountries.gdp$country == 'Bangladesh' | topcountries.gdp$country == 'World'),] %>% arrange(Year) %>%
  ggplot(aes(x=Year, y=GDP, group = country, color = country)) +
  geom_line(size = 1) +
  geom_point() +
  labs(title = 'World & Bangladesh GDP 2012 - 2021')
#gdp.bangladesh

gdp.pakistan <- topcountries.gdp[ which (topcountries.gdp$country == 'Pakistan' | topcountries.gdp$country == 'World'),] %>% arrange(Year) %>%
  ggplot(aes(x=Year, y=GDP, group = country, color = country)) +
  geom_line(size = 1) +
  geom_point() +
  labs(title = 'World & Pakistan GDP 2012 - 2021')
#gdp.pakistan

gdp.turkey <- topcountries.gdp[ which (topcountries.gdp$country == 'Turkey' | topcountries.gdp$country == 'World'),] %>% arrange(Year) %>%
  ggplot(aes(x=Year, y=GDP, group = country, color = country)) +
  geom_line(size = 1) +
  geom_point() +
  labs(title = 'World & Turkey GDP 2012 - 2021')
#gdp.turkey

gdp.italy <- topcountries.gdp[ which (topcountries.gdp$country == 'Italy' | topcountries.gdp$country == 'World'),] %>% arrange(Year) %>%
  ggplot(aes(x=Year, y=GDP, group = country, color = country)) +
  geom_line(size = 1) +
  geom_point() +
  labs(title = 'World & Italy GDP 2012 - 2021')
#gdp.italy

gdp.germany <- topcountries.gdp[ which (topcountries.gdp$country == 'Germany' | topcountries.gdp$country == 'World'),] %>% arrange(Year) %>%
  ggplot(aes(x=Year, y=GDP, group = country, color = country)) +
  geom_line(size = 1) +
  geom_point() +
  labs(title = 'World & Germany GDP 2012 - 2021')
#gdp.germany
```

```{r}
grid.arrange(gdp.all)

grid.arrange(gdp.us, gdp.brazil, nrow=2)
grid.arrange(gdp.india, gdp.russia, nrow=2)
grid.arrange(gdp.peru, gdp.southAf, nrow=2)
grid.arrange(gdp.colombia, gdp.mexico, nrow=2)
grid.arrange(gdp.spain, gdp.argentina, nrow=2)
grid.arrange(gdp.chile, gdp.iran, nrow=2)
grid.arrange(gdp.uk, gdp.france, nrow=2)
grid.arrange(gdp.saudi, gdp.bangladesh, nrow=2)
grid.arrange(gdp.pakistan, gdp.turkey, nrow=2)
grid.arrange(gdp.italy, gdp.germany, nrow=2)


#grid.arrange(gdp.us, gdp.brazil, gdp.india, gdp.russia, gdp.peru, gdp.southAf, gdp.colombia, gdp.mexico, #gdp.spain, gdp.argentina, gdp.chile, gdp.iran, gdp.uk, gdp.france, gdp.saudi, gdp.bangladesh, #gdp.pakistan, gdp.turkey, gdp.italy, gdp.germany, nrow=20)


```

```{r}
topcountries.gdp2020 <- top.countries %>% merge(dataYear, by = "country")
topcountries.gdp2020 <- topcountries.gdp2020[,(names(topcountries.gdp2020) %in% c("country","confirmed","GDP"))]
topcountries.gdp2020 <- topcountries.gdp2020 %>% arrange(desc(confirmed))
View(topcountries.gdp2020)
```


